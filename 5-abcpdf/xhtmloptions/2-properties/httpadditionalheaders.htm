<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>XHtmlOptions HttpAdditionalHeaders Property. Additional HTTP headers to send in the request. ABCpdf .NET PDF Library.</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="../../../mystyles.css">
<link rel="stylesheet" href="../../../prism.css">
<script src="../../../prism.js"></script>
<META content="MSHTML 6.00.6000.16640" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<TABLE cellSpacing=4 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top><IMG height=60 src="../../../images/goo.gif" width=58></TD>
    <TD width=14>&nbsp;</TD>
    <TD>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=pageheader>HttpAdditionalHeaders Property</TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD background=../../../images/steel-line-3.gif height=11></TD>
          <TD width=60 background=../../../images/steel-line-3.gif 
          height=11></TD>
          <TD height=11><IMG height=11 src="../../../images/steel-blob-11.gif" 
            width=11></TD></TR>
        <TR>
          <TD>
            <P>&nbsp;</P>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0 
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B>Type</B></TD>
                <TD><B>Default Value</B></TD>
                <TD><B>Read Only</B></TD>
                <TD><B>Description</B></TD></TR>
              <TR vAlign=top>
                <TD align=left><SPAN 
                  class=language>[C#]</SPAN><BR><CODE>string</CODE><BR><BR><SPAN 
                  class=language>[Visual&nbsp;Basic]</SPAN><BR><CODE>String</CODE></TD>
                <TD>""</TD>
                <TD>No</TD>
                <TD>Additional HTTP headers to send in the request.</TD></TR></TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Notes</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>This property specifies HTTP headers added to the default
            headers. It must follow the syntax of HTTP headers, typically delimited using a cr+lf combination.</P>
            <P>For example, you may add the cookies from a response to a
            request under some authentication (e.g. ASP.NET Forms) where a session
            ID is returned for subsequent requests so re-authentication is
            not needed. See the <A href="nocookie.htm">NoCookie</A> property
            for further information if you specify cookies in the HTTP headers.</P>
            <P>The headers are sent only in the request for the URL; they
            are not sent in the requests for the linked resources (e.g. CSS and images)
            in the obtained HTML page.</P>
            <P>The additional headers are always used by the MSHTML <a href="1-engine.htm">Engine</a>. Under Gecko, these headers are only sent if you are using the Screen <a href="media.htm">Media</a> or if you are using the POST <a href="requestmethod.htm">RequestMethod</a>. When this occurs, ABCpdf needs to obtain and store a local copy of the web page before invoking the engine. This property is not valid under ABCChrome.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Example</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>The following example shows how this property may be used.</P>
            <P><SPAN class=language>[C#]</SPAN><BR>
            <pre><code class="language-csharp">using var doc = new Doc();
string url = "https://www.websupergoo.com/"; // assign appropriate URL
var request = (HttpWebRequest)WebRequest.Create(url);
request.CookieContainer = new CookieContainer(); // required for HttpWebResponse.Cookies
request.Credentials = null; // assign appropriate credentials
using (var resp = request.GetResponse()) {
&nbsp;&nbsp;// cookieless Forms Authentication adds authentication ticket to the URL
&nbsp;&nbsp;url = resp.ResponseUri.AbsoluteUri;
&nbsp;&nbsp;var response = (HttpWebResponse)resp;
&nbsp;&nbsp;if (response.Cookies.Count &gt; 0) { // includes ASP.NET_SessionId
&nbsp;&nbsp;&nbsp;&nbsp;bool needsCookie2 = false;
&nbsp;&nbsp;&nbsp;&nbsp;var builder = new StringBuilder("Cookie: ");
&nbsp;&nbsp;&nbsp;&nbsp;for (int i = 0; i &lt; response.Cookies.Count; ++i) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var cookie = response.Cookies[i];
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (!needsCookie2 &amp;&amp; cookie.Version != 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needsCookie2 = true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (i &gt; 0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append("; ");
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(cookie.ToString());
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(!needsCookie2 ? "\r\n" : "\r\nCookie2: $Version=1\r\n");
&nbsp;&nbsp;&nbsp;&nbsp;doc.HtmlOptions.HttpAdditionalHeaders = builder.ToString();
&nbsp;&nbsp;}
}
doc.HtmlOptions.Engine = EngineType.MSHtml;
doc.HtmlOptions.NoCookie = true;
doc.HtmlOptions.PageLoadMethod = PageLoadMethodType.MonikerForHtml;
int id = doc.AddImageUrl(url);
doc.Save(Server.MapPath("HttpHeaders.pdf"));
</code></pre><BR><SPAN 
            class=language>[Visual Basic]</SPAN><BR>
<pre><code class="language-vbnet">Using doc As New Doc()
&nbsp;&nbsp;Dim url As String = "https://www.websupergoo.com/"
&nbsp;&nbsp;' assign appropriate URL
&nbsp;&nbsp;Dim request As HttpWebRequest = DirectCast(WebRequest.Create(url), HttpWebRequest)
&nbsp;&nbsp;request.CookieContainer = New CookieContainer()
&nbsp;&nbsp;' required for HttpWebResponse.Cookies
&nbsp;&nbsp;request.Credentials = Nothing
&nbsp;&nbsp;' assign appropriate credentials
&nbsp;&nbsp;Using resp As WebResponse = request.GetResponse()
&nbsp;&nbsp;&nbsp;&nbsp;' cookieless Forms Authentication adds authentication ticket to the URL
&nbsp;&nbsp;&nbsp;&nbsp;url = resp.ResponseUri.AbsoluteUri
&nbsp;&nbsp;&nbsp;&nbsp;Dim response As HttpWebResponse = DirectCast(resp, HttpWebResponse)
&nbsp;&nbsp;&nbsp;&nbsp;If response.Cookies.Count &gt; 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;' includes ASP.NET_SessionId
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim needsCookie2 As Boolean = False
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim builder As New StringBuilder("Cookie: ")
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim i As Integer = 0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While i &lt; response.Cookies.Count
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim cookie As Cookie = response.Cookies(i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If Not needsCookie2 AndAlso cookie.Version &lt;&gt; 1 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;needsCookie2 = True
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;If i &gt; 0 Then
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append("; ")
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(cookie.ToString())
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Threading.Interlocked.Increment(i)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End While
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;builder.Append(If(Not needsCookie2, vbCr &amp; vbLf, vbCr &amp; vbLf &amp; "Cookie2: $Version=1" &amp; vbCr &amp; vbLf))
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.HtmlOptions.HttpAdditionalHeaders = builder.ToString()
&nbsp;&nbsp;&nbsp;&nbsp;End If
&nbsp;&nbsp;End Using
&nbsp;&nbsp;doc.HtmlOptions.Engine = EngineType.MSHtml
&nbsp;&nbsp;doc.HtmlOptions.NoCookie = True
&nbsp;&nbsp;doc.HtmlOptions.PageLoadMethod = PageLoadMethodType.MonikerForHtml
&nbsp;&nbsp;Dim id As Integer = doc.AddImageUrl(url)
&nbsp;&nbsp;doc.Save(Server.MapPath("HttpHeaders.pdf"))
End Using
</code></pre>
</P>
            <TABLE class=backgrounder cellPadding=10 border=0>
              <TBODY>
              <TR>
                <TD>
                  <P><B>ASP.NET_SessionId.</B> If your application runs in ASP.NET,
                  you cannot use the cookie from the application's originating
                  request as it identifies the session. If the site containing
                  the target HTML page is different from your site, the session
                  ID is invalid. If it is the same, this will cause a re-entrance
                  in the same session, and ASP.NET may not allow re-entrance
                  for the same session.</P></TD></TR></TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<P>&nbsp;</P></BODY></HTML>
