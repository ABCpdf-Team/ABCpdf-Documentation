<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>XHtmlOptions OnLoadScript Property. A script to be run after the page is loaded. ABCpdf .NET PDF Library.</title>




<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../../../mystyles.css">
<link rel="stylesheet" href="../../../prism.css">
<script src="../../../prism.js"></script></head><body bgcolor="#ffffff">
<table border="0" cellpadding="0" cellspacing="4">
  <tbody><tr> 
    <td valign="top"><img src="../../../images/goo.gif" height="60" width="58"></td>
    <td width="14">&nbsp;</td>
    <td> 
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody><tr> 
          <td class="pageheader">OnLoadScript Property</td>
          <td width="60">&nbsp;</td>
          <td>&nbsp;</td>
        </tr>
        <tr> 
          <td background="../../../images/steel-line-3.gif" height="11"><br>
</td>
          <td background="../../../images/steel-line-3.gif" height="11" width="60"><br>
</td>
          <td height="11"><img src="../../../images/steel-blob-11.gif" height="11" width="11"></td>
        </tr>
        <tr> 
          <td> 
            <p>&nbsp;</p>
            <table class="wsgtable" border="5" bordercolor="#ffffff" cellpadding="3" cellspacing="0"> 
              <tbody><tr> 
                <td align="center"><b>Type</b></td>
                <td><b>Default Value</b></td>
                <td><b>Read Only</b></td>
                <td><b>Description</b></td>
              </tr>
              <tr valign="top"> 
                <td align="left"><span class="language">[C#]</span><br>
                  <code>string</code><br>
                  <br>
                  <span class="language">[Visual&nbsp;Basic]</span><br>
                  <code>String</code></td>
                <td>""</td>
                <td>No</td>
                <td>A script to be run after the page is loaded.</td>
              </tr>
            </tbody></table>
            <p>&nbsp;</p>
          </td>
          <td width="60">&nbsp;</td>
          <td>&nbsp;</td>
        </tr>
      </tbody></table>
    </td>
  </tr>
  <tr> 
    <td class="sectheader" valign="top"><img src="../../../images/steel-pin.gif" height="10" width="64"><br>Notes</td>
    <td width="14">&nbsp;</td>
    <td valign="top"> 
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody><tr> 
          <td> 
            <p>A client side JavaScript to be applied to a web page before the 
              page is rendered to PDF.</p>
            <p>This kind of script can be used for a variety of purposes. For 
              example you might wish to hide background images or get pre-render 
              information from the document.</p>
            <p>You can provide a return value by setting an "abcpdf" 
              property in the documentElement. For example:</p>
            <p><span class="language">[C#]</span><br>
<pre><code class="language-csharp">document.documentElement.abcpdf = "my return value";
</code></pre><br>
<span class="language">[Visual Basic]</span><br>
<pre><code class="language-vbnet">document.documentElement.abcpdf = "my return value"
</code></pre></p>
            <p>The return value can be accessed using the <a href="../1-methods/getscriptreturn.htm">GetScriptReturn</a> 
              method with the ID returned from <a href="../../doc/1-methods/addimageurl.htm">Doc.AddImageUrl</a> 
              or <a href="../../doc/1-methods/addimagehtml.htm">Doc.AddImageHtml</a>.</p>
            <p>For the MSHtml engine, you must have the <a href="usescript.htm">UseScript</a> 
              key set to true or you will get an "access denied" error; the return
              value can only be set inside <a href="onloadscript.htm">OnLoadScript</a>.
              The Gecko engine does not have these restrictions.</p>
            <p>For the MSHtml engine, the script in this property is executed after
              the page load is complete, so it may be executed before or after any
              script in the web page that is executed after the completion of page load.</p>
            <p>For the Gecko engine, the script in this property may be executed
              before or after any event-triggered script in the web page. For example, if you set
              window.ABCpdf_go to false in OnLoadScript, but the event listener that
              sets window.ABCpdf_go to true is in the script in the web page,
              you should check the value of window.ABCpdf_go (initially undefined)
              before setting it to false in OnLoadScript.</p>
            <p><span class="language">[C#]</span><br>
<pre><code class="language-csharp">doc.HtmlOptions.OnLoadScript = "if(!window.ABCpdf_go) window.ABCpdf_go = false;";
</code></pre><br>
<span class="language">[Visual Basic]</span><br>
<pre><code class="language-vbnet">doc.HtmlOptions.OnLoadScript = "if(!window.ABCpdf_go) window.ABCpdf_go = false;"
</code></pre></p>
            <p>For the ABCChrome engine, the script is run at the point that the page and all resources that are referred to by the page, are loaded.</p>
            <p>&nbsp;</p></td>
          <td width="60">&nbsp;</td>
          <td width="11">&nbsp;</td>
        </tr>
      </tbody></table>
    </td>
  </tr>
  <tr> 
    <td class="sectheader" valign="top"><img src="../../../images/steel-pin.gif" height="10" width="64"><br>Example</td>
    <td width="14">&nbsp;</td>
    <td valign="top"> 
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
        <tbody><tr> 
          <td> 
            <p>See the <a href="usescript.htm">UseScript</a> property.</p>
            <p>Also see example code in: <a href="usescript.htm">XHtmlOptions UseScript Property</a>.</p>
            <p>&nbsp;</p>
            </td>
          <td width="60">&nbsp;</td>
          <td width="11">&nbsp;</td>
        </tr>
      </tbody></table>
    </td>
  </tr>
</tbody></table>
<p>&nbsp;</p>
</body></html>