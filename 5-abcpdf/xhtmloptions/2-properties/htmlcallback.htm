<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>XHtmlOptions HtmlCallback Property. The multicast delegate to be called while HTML rendering is taking place. ABCpdf .NET PDF Library.</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="../../../mystyles.css">
<link rel="stylesheet" href="../../../prism.css">
<script src="../../../prism.js"></script>
<META content="MSHTML 6.00.6000.16788" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<TABLE cellSpacing=4 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top><IMG height=60 src="../../../images/goo.gif" width=58></TD>
    <TD width=14>&nbsp;</TD>
    <TD>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=pageheader>HtmlCallback Property</TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD background=../../../images/steel-line-3.gif height=11></TD>
          <TD width=60 background=../../../images/steel-line-3.gif 
          height=11></TD>
          <TD height=11><IMG height=11 src="../../../images/steel-blob-11.gif" 
            width=11></TD></TR>
        <TR>
          <TD>
            <P>&nbsp;</P>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0 
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B>Type</B></TD>
                <TD><B>Default Value</B></TD>
                <TD><B>Read Only</B></TD>
                <TD><B>Description</B></TD></TR>
              <TR vAlign=top>
                <TD align=left><SPAN 
                  class=language>[C#]</SPAN><BR><CODE>HtmlCallback</CODE><BR><BR><SPAN 
                  class=language>[Visual&nbsp;Basic]</SPAN><BR><CODE>HtmlCallback</CODE></TD>
                <TD>null</TD>
                <TD>No</TD>
                <TD>The multicast delegate to be called while HTML rendering 
                  is taking place.</TD></TR></TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Notes</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>This delegate is called during HTML rendering.</P>
            <P>During the time that HTML rendering is taking place delegates are 
            called periodically. This gives a mechanism for tracking progress 
            and for intercepting and modifying or querying pages on the fly.</P>
            <P>If the page is obtained from the <A 
            href="pagecacheenabled.htm">cache</A> then the delegate will not be 
            called.</P>
            <P>Note that the amount of work done during a callback should be 
            kept to a minimum.</P>
            <P></P>
            <P>The definition of the HtmlCallback multicast delegate is as 
            follows.</P>
            <P><SPAN class=language>[C#]</SPAN><BR><pre><code class="language-csharp">delegate void HtmlCallback(string stage, object page);
</code></pre><BR><BR><SPAN 
            class=language>[Visual&nbsp;Basic]</SPAN><BR><pre><code class="language-vbnet">Delegate Sub HtmlCallback(stage As String, page As Object);
</code></pre></P>
            <P>Current values for the stage variable are 'get width', 'get 
            height' and 'render'. The first occurs prior to finding the natural 
            width of the HTML (the width it can occupy without scrolling). The 
            second occurs prior to finding the natural height. The third occurs 
            prior to translation into PDF format.</P>
            <P>The page is provided via a mshtml.HTMLDocumentClass object - see 
            Microsoft documentation for details. However note that while the 
            interface is standard the behavior may not be identical. For example 
            element positions may not be available.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Example</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>The following example shows the effect that this parameter has on 
            HTML rendering.</P>
            <P><SPAN class=language>[C#]</SPAN><BR>
            <pre><code class="language-csharp">using var doc = new Doc();
string uri = "https://photojournal.jpl.nasa.gov/catalog/PIA24312";
// Set up the callback
var theLog = new StringBuilder();
doc.HtmlOptions.HtmlCallback = (string stage, object page) =&gt; theLog.AppendLine(stage);
// Render html page
doc.AddImageUrl(uri);
// Add log over the top of the content
doc.Rect.Inset(100, 100);
doc.Color.String = "255 0 0";
doc.FontSize = 96;
doc.AddText(theLog.ToString());
// Save the document
doc.Save(Server.MapPath("HtmlOptionsCallback.pdf"));
</code></pre>
            <BR><SPAN 
            class=language>[Visual Basic]</SPAN><BR>
<pre><code class="language-vbnet">Using doc As New Doc()
&nbsp;&nbsp;Dim theURL As String = "https://photojournal.jpl.nasa.gov/catalog/PIA24312"
&nbsp;&nbsp;' Set up the callback
&nbsp;&nbsp;Dim theLog As New StringBuilder()
&nbsp;&nbsp;doc.HtmlOptions.HtmlCallback = Function(stage As String, page As Object) theLog.AppendLine(stage)
&nbsp;&nbsp;' Render html page
&nbsp;&nbsp;doc.AddImageUrl(theURL)
&nbsp;&nbsp;' Add log over the top of the content
&nbsp;&nbsp;doc.Rect.Inset(100, 100)
&nbsp;&nbsp;doc.Color.String = "255 0 0"
&nbsp;&nbsp;doc.FontSize = 96
&nbsp;&nbsp;doc.AddText(theLog.ToString())
&nbsp;&nbsp;' Save the document
&nbsp;&nbsp;doc.Save(Server.MapPath("HtmlOptionsCallback.pdf"))
End Using
</code></pre></P>
            <P><IMG
            src="../../../images/pdf/HtmlOptionsCallback.pdf.png" class="example"><BR>HtmlOptionsCallback.pdf</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<P>&nbsp;</P></BODY></HTML>
