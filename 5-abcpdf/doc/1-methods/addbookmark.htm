<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>Doc AddBookmark Function. Adds a bookmark pointing to the current page. ABCpdf .NET PDF Library.</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="../../../mystyles.css">
<link rel="stylesheet" href="../../../prism.css">
<script src="../../../prism.js"></script>
<META content="MSHTML 6.00.6000.16640" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<TABLE cellSpacing=4 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top><IMG height=60 src="../../../images/goo.gif" width=58></TD>
    <TD width=14>&nbsp;</TD>
    <TD>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=pageheader>AddBookmark Function</TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD background=../../../images/steel-line-3.gif height=11></TD>
          <TD width=60 background=../../../images/steel-line-3.gif 
          height=11></TD>
          <TD height=11><IMG height=11 src="../../../images/steel-blob-11.gif" 
            width=11></TD></TR>
        <TR>
          <TD>
            <P>Adds a bookmark pointing to the current page.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Syntax</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <p><span class="language">[C#]</span><br>
            <pre><code class="language-csharp">int AddBookmark(string path, bool open);
</code></pre><br>
            <span class="language">[Visual Basic]</span><br>
            <pre><code class="language-vbnet">Function AddBookmark(path As String, open As Boolean) As Integer
</code></pre></p>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Params</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0 
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B>Name</B></TD>
                <TD><B>Description</B></TD></TR>
              <TR vAlign=top>
                <TD align=middle>path</TD>
                <TD>
                  <P>The path to the bookmark.</P></TD></TR>
              <TR vAlign=top>
                <TD align=middle>open</TD>
                <TD>Whether the bookmark should be displayed open (expanded) 
                  or closed (collapsed).</TD></TR>
              <TR vAlign=top>
                <TD align=middle>return</TD>
                <TD>The Object ID of the newly added Bookmark 
              Object.</TD></TR></TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Notes</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>Adds a bookmark which points to the current page.</P>
            <P>Bookmarks are specified as paths in much the same way as file 
            paths. Headings and subheadings are separated by a backslash 
            character. For example:</P>
            <P><SAMP>"1. Introduction\1.1 Aim and Methods\1.1.3 
            Diagrams"</SAMP></P>
            <P>When a bookmark is added, intermediate headings and subheadings 
            will be created if they do not already exist.</P>
            <P>To add multiple bookmarks all referring to the same page simply 
            call the AddBookmark function multiple times.</P>
            <P>This function returns the Object ID of the newly added Bookmark 
            Object.</P>
            <TABLE class=backgrounder border=0 cellPadding=10>
              <TBODY>
                <TR>
                  <TD><P><B>Hyperlinks. </B>Sometimes you may wish to insert bookmarks which link to an external web page specified using a URI or URL. You can do this using hyperlink code of the following form. Please do ensure that your URLs come from trusted sources only. You do not want to be in a situation in which people can add links to malware or other dubious locations.</P>
            <p><span class="language">[C#]</span><br>
            <pre><code class="language-csharp">static int AddBookmarkToUri(Doc doc, string bookmark, string uri) {
&nbsp;&nbsp;int id = doc.AddBookmark(bookmark, true);
&nbsp;&nbsp;doc.SetInfo(id, &quot;/Dest:Del&quot;, &quot;&quot;); // remove link to page and add link to url
&nbsp;&nbsp;doc.SetInfo(id, &quot;/A&quot;, &quot;&lt;&lt; /Type /Action /S /URI /URI () &gt;&gt;&quot;);
&nbsp;&nbsp;doc.SetInfo(id, &quot;/A/URI:Text&quot;, uri);
&nbsp;&nbsp;return id;
}
</code></pre><br>
            <span class="language">[Visual Basic]</span><br>
            <pre><code class="language-vbnet">Private Shared Function AddBookmarkToUri(ByVal doc As Doc, ByVal bookmark As String, ByVal uri As String) As Integer
&nbsp;&nbsp;Dim id As Integer = doc.AddBookmark(bookmark, True)
&nbsp;&nbsp;doc.SetInfo(id, &quot;/Dest:Del&quot;, &quot;&quot;, &quot;&quot;) ' remove link to page and add link to url
&nbsp;&nbsp;doc.SetInfo(id,  &quot;/A&quot;, &quot;&lt;&lt; /Type /Action /S /URI /URI () &gt;&gt;&quot;)
&nbsp;&nbsp;doc.SetInfo(id, &quot;/A/URI:Text&quot;, uri)
&nbsp;&nbsp;Return id
End Function
</code></pre></p>
                    </TD>
                </TR>
              </TBODY>
            </TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../images/steel-pin.gif" width=64><BR>Example</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>The following code adds a sequence of pages with a nested 
            sequence of bookmarks. The image shows the appearance of the 
            document outline. Note that none of the subject pages are visible 
            because the chapter pages were added in a collapsed state.</P>
            <P><SPAN class=language>[C#]</SPAN><BR><pre><code class="language-csharp">using var doc = new Doc();
doc.FontSize = 64;
for (int i = 1; i &lt; 4; i++) {
&nbsp;&nbsp;doc.Page = doc.AddPage();
&nbsp;&nbsp;string theSection = $"{i} Section";
&nbsp;&nbsp;doc.AddText(theSection);
&nbsp;&nbsp;doc.AddBookmark(theSection, true);
&nbsp;&nbsp;for (int j = 1; j &lt; 6; j++) {
&nbsp;&nbsp;&nbsp;&nbsp;doc.Page = doc.AddPage();
&nbsp;&nbsp;&nbsp;&nbsp;string theChapter = $"{theSection}\\{j} Chapter";
&nbsp;&nbsp;&nbsp;&nbsp;doc.AddText(theChapter);
&nbsp;&nbsp;&nbsp;&nbsp;doc.AddBookmark(theChapter, false);
&nbsp;&nbsp;&nbsp;&nbsp;for (int k = 1; k &lt; 7; k++) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Page = doc.AddPage();
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;string theSubject = $"{theChapter}\\{k} Subject";
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddText(theSubject);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddBookmark(theSubject, true);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}
}
doc.Save(Server.MapPath("docaddbookmark.pdf"));
</code></pre><BR><SPAN 
            class=language>[Visual Basic]</SPAN><BR><pre><code class="language-vbnet">Using doc As New Doc()
&nbsp;&nbsp;doc.FontSize = 64
&nbsp;&nbsp;Dim i As Integer = 1
&nbsp;&nbsp;While i &lt; 4
&nbsp;&nbsp;&nbsp;&nbsp;doc.Page = doc.AddPage()
&nbsp;&nbsp;&nbsp;&nbsp;Dim theSection As String = $"{i} Section"
&nbsp;&nbsp;&nbsp;&nbsp;doc.AddText(theSection)
&nbsp;&nbsp;&nbsp;&nbsp;doc.AddBookmark(theSection, True)
&nbsp;&nbsp;&nbsp;&nbsp;Dim j As Integer = 1
&nbsp;&nbsp;&nbsp;&nbsp;While j &lt; 6
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Page = doc.AddPage()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim theChapter As String = $"{theSection}\{j} Chapter"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddText(theChapter)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddBookmark(theChapter, False)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim k As Integer = 1
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;While k &lt; 7
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.Page = doc.AddPage()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Dim theSubject As String = $"{theChapter}\{k} Subject"
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddText(theSubject)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;doc.AddBookmark(theSubject, True)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Math.Max(System.Threading.Interlocked.Increment(k),k - 1)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;End While
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;System.Math.Max(System.Threading.Interlocked.Increment(j),j - 1)
&nbsp;&nbsp;&nbsp;&nbsp;End While
&nbsp;&nbsp;&nbsp;&nbsp;System.Math.Max(System.Threading.Interlocked.Increment(i),i - 1)
&nbsp;&nbsp;End While
&nbsp;&nbsp;doc.Save(Server.MapPath("docaddbookmark.pdf"))
End Using
</code></pre></P>
            <P><IMG src="../../../images/pdf/docaddbookmark.gif" class="example"><BR>docaddbookmark.pdf </P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<P>&nbsp;</P></BODY></HTML>
