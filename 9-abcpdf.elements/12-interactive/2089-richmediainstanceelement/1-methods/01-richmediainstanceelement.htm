<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><title>ZZ Elements RichMediaInstanceElement Constructor Function</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1"><link rel="stylesheet" href="../../../../mystyles.css">
<link rel="stylesheet" href="../../../../prism.css">
<script src="../../../../prism.js"></script>
<META content="MSHTML 6.00.6000.16809" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<TABLE cellSpacing=4 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top><IMG height=60 src="../../../../images/goo.gif" width=58></TD>
    <TD width=14>&nbsp;</TD>
    <TD>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=pageheader>RichMediaInstanceElement Function</TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD background="../../../../images/steel-line-3.gif" height=11></TD>
          <TD width=60 background="../../../../images/steel-line-3.gif" 
          height=11></TD>
          <TD height=11><IMG height=11 src="../../../../images/steel-blob-11.gif" 
            width=11></TD></TR>
        <TR>
          <TD>
            <P>Create a new <a href="../default.htm">RichMediaInstanceElement</a>.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../../images/steel-pin.gif" width=64><BR>Syntax</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <P><SPAN class=language>[C#]</SPAN><BR>
            <CODE> <a href="../default.htm">RichMediaInstanceElement</a>()<br> <a href="../default.htm">RichMediaInstanceElement</a>(Atom atom, IndirectObject host)<br> <a href="../default.htm">RichMediaInstanceElement</a>(IndirectObject obj)<br> <a href="../default.htm">RichMediaInstanceElement</a>(<a href="../../../01-base/1086-element/default.htm">Element</a> relation, CreationOptions options)<BR>
            </CODE><BR><SPAN class=language>[Visual Basic]</SPAN><BR>
            <CODE><a href="../default.htm">RichMediaInstanceElement</a>()<br><a href="../default.htm">RichMediaInstanceElement</a>(atom As Atom, host As IndirectObject)<br><a href="../default.htm">RichMediaInstanceElement</a>(obj As IndirectObject)<br><a href="../default.htm">RichMediaInstanceElement</a>(relation As <a href="../../../01-base/1086-element/default.htm">Element</a>, options As CreationOptions)<BR>
            </CODE>
			</P>
			
			
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../../images/steel-pin.gif" width=64><BR>Params</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0 
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B>Name</B></TD>
                <TD><B>Description</B></TD></TR>
              <TR vAlign=top>
                <TD align=middle>atom</TD>
                <TD>The Atom to be assigned to this <a href="../../../01-base/1086-element/default.htm">Element</a>.</TD>
              </TR>
<TR vAlign=top>
                <TD align=middle>host</TD>
                <TD>An IndirectObject. This can be any IndirectObject from the Soup but ideally should be one closely associated with the Atom.</TD>
              </TR>
<TR vAlign=top>
                <TD align=middle>obj</TD>
                <TD>The IndirectObject to be assigned to this <a href="../../../01-base/1086-element/default.htm">Element</a>.</TD>
              </TR>
<TR vAlign=top>
                <TD align=middle>relation</TD>
                <TD>An <a href="../../../01-base/1086-element/default.htm">Element</a>. This can be any <a href="../../../01-base/1086-element/default.htm">Element</a> in the Soup but ideally should be one closely associated with this <a href="../../../01-base/1086-element/default.htm">Element</a>.</TD>
              </TR>
<TR vAlign=top>
                <TD align=middle>options</TD>
                <TD>Options related to creation. For example this allows you to determine whether the <a href="../../../01-base/1086-element/default.htm">Element</a> should be created using an IndirectObject rather than just an Atom. If not provided a default set of options is used.</TD>
              </TR>
</TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../../images/steel-pin.gif" width=64><BR>Notes</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            
<p>Create a new <a href="../default.htm">RichMediaInstanceElement</a>.</p>
<p>The different constructors allow different ways of creating an <a href="../../../01-base/1086-element/default.htm">Element</a>. Some are used for wrapping existing Atoms or IndirectObjects and others are for creating new ones.</p>
<p>The constructor taking a relation <a href="../../../01-base/1086-element/default.htm">Element</a> creates a new object in the document - it is typically the constructor you will want to use. Do not specify creation options unless you have very specific needs.</p>
<p>However for your first <a href="../../../01-base/1086-element/default.htm">Element</a> - one you can use as a relation for the others - you will need to wrap an existing IndirectObject inside an <a href="../../../01-base/1086-element/default.htm">Element</a>. For this you might use code of the following form "<a href="../../../07-syntax/1081-catalogelement/default.htm">CatalogElement</a> root =  new <a href="../../../07-syntax/1081-catalogelement/default.htm">CatalogElement</a>(doc.ObjectSoup.Catalog)".</p>
<p>The parameterless constructor allows you to create an empty <a href="../../../01-base/1086-element/default.htm">Element</a>. By empty we mean it has no contents - no Atom within it. So before use an Atom must be Assigned or Created. In practice it is easiest to do this using one of the other constructors.</p>
<p>The atom and host constructor is used to wrap an existing Atom. It creates an <a href="../../../01-base/1086-element/default.htm">Element</a> and then Assigns the Atom to it. The result is a specialized <a href="../../../01-base/1086-element/default.htm">Element</a> which can be used to examine or modify the contents of the Atom.</p>


<p>The CreationOptions enumeration may take the following values:</p>
<ul>
<li>Default - Default creation options for this particular type of <a href="../../../01-base/1086-element/default.htm">Element</a>.</li>
<li>Indirect - Create <a href="../../../01-base/1086-element/default.htm">Element</a> containing an IndirectObject.</li>
<li>Direct - Create <a href="../../../01-base/1086-element/default.htm">Element</a> containing an Atom.</li>
</ul>


            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10 
      src="../../../../images/steel-pin.gif" width=64><BR>Example</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>This code snippet is taken from Annotations.cs line 1803 in the Annotations example project.</P>
<P><SPAN class=language>[C#]</SPAN><BR><pre><code class="language-csharp">if (mediaType != &quot;Flash&quot; &amp;&amp; mediaType != &quot;Video&quot; &amp;&amp; mediaType != &quot;Sound&quot; &amp;&amp; mediaType != &quot;3D&quot;)
&nbsp;&nbsp;throw new ArgumentException(&quot;Invalid media type.&quot;, &quot;mediaType&quot;);

<a href="../../2077-richmediaannotationelement/default.htm">RichMediaAnnotationElement</a> annot = new <a href="../../2077-richmediaannotationelement/default.htm">RichMediaAnnotationElement</a>(AnnotationElement.Object);
annot.EntrySubtype = &quot;RichMedia&quot;;
annot.EntryRect = new <a href="../../../07-syntax/0017-rectangleelement/default.htm">RectangleElement</a>(ArrayAtom.FromXRect(new XRect(rect)), annot.Host);

string fileName;
<a href="../../../07-syntax/1110-fullfilespecificationelement/default.htm">FullFileSpecificationElement</a> fileSpec = new <a href="../../../07-syntax/1110-fullfilespecificationelement/default.htm">FullFileSpecificationElement</a>(annot);
fileSpec.EntryType = &quot;Filespec&quot;;
if (filePathOrUrl.StartsWith(&quot;http://&quot;, StringComparison.OrdinalIgnoreCase)
&nbsp;&nbsp;|| filePathOrUrl.StartsWith(&quot;https://&quot;, StringComparison.OrdinalIgnoreCase)
&nbsp;&nbsp;|| filePathOrUrl.StartsWith(&quot;rtmp://&quot;, StringComparison.OrdinalIgnoreCase)) {
&nbsp;&nbsp;fileSpec.EntryFS = &quot;URL&quot;;
&nbsp;&nbsp;fileName = FixUrl(filePathOrUrl);
}
else {
&nbsp;&nbsp;FileInfo fileInfo = new FileInfo(filePathOrUrl);
&nbsp;&nbsp;fileSpec.EntryEF = new <a href="../../../07-syntax/1111-embeddedfilesetelement/default.htm">EmbeddedFileSetElement</a>(annot);
&nbsp;&nbsp;fileSpec.EntryEF.EntryF = EmbedFileStream(fileInfo);
&nbsp;&nbsp;fileName = EncodeName(fileInfo.Name);
}
fileSpec.EntryF = fileName;
fileSpec.EntryUF = fileName;

annot.Object.AdbeExtLevel = new int[] { 7, 3 };
<a href="../../2086-richmediacontentelement/default.htm">RichMediaContentElement</a> content = new <a href="../../2086-richmediacontentelement/default.htm">RichMediaContentElement</a>(annot, CreationOptions.Indirect);
content.EntryType = &quot;RichMediaContent&quot;;
content.EntryAssets = new <a href="../../../07-syntax/1097-nametreenodeelement_t_/default.htm">NameTreeNodeElement</a>&lt;<a href="../../../07-syntax/0011-filespecificationelement/default.htm">FileSpecificationElement</a>&gt;(annot, CreationOptions.Indirect);
content.EntryAssets.EntryNames = new <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>&lt;<a href="../../../01-base/1086-element/default.htm">Element</a>&gt;(annot);
content.EntryAssets.EntryNames.Add(new <a href="../../../01-base/1086-element/default.htm">Element</a>(new StringAtom(fileName), annot.Host));
content.EntryAssets.EntryNames.Add(fileSpec);

<a href="../../2088-richmediaconfigelement/default.htm">RichMediaConfigElement</a> configuration = new <a href="../../2088-richmediaconfigelement/default.htm">RichMediaConfigElement</a>(annot, CreationOptions.Indirect);
configuration.EntryType = &quot;RichMediaConfiguration&quot;;
configuration.EntrySubtype = mediaType;
<a href="../default.htm">RichMediaInstanceElement</a> instance = new <a href="../default.htm">RichMediaInstanceElement</a>(annot, CreationOptions.Indirect);
instance.EntryType = &quot;RichMediaInstance&quot;;
instance.EntrySubtype = mediaType;
instance.EntryParams = new <a href="../../2090-richmediaparamselement/default.htm">RichMediaParamsElement</a>(annot);
instance.EntryParams.EntryType = &quot;RichMediaParams&quot;;
instance.EntryParams.EntryBinding = &quot;Foreground&quot;;
instance.EntryAsset = fileSpec;
configuration.EntryInstances = new <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>&lt;<a href="../default.htm">RichMediaInstanceElement</a>&gt;(annot);
configuration.EntryInstances.Add(instance);

content.EntryConfigurations = new <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>&lt;<a href="../../2088-richmediaconfigelement/default.htm">RichMediaConfigElement</a>&gt;(annot);
content.EntryConfigurations.Add(configuration);
annot.EntryRichMediaContent = content;

<a href="../../2078-richmediasettingselement/default.htm">RichMediaSettingsElement</a> settings = new <a href="../../2078-richmediasettingselement/default.htm">RichMediaSettingsElement</a>(annot, CreationOptions.Indirect);
settings.EntryType = &quot;RichMediaSettings&quot;;
settings.EntryActivation = new <a href="../../2079-richmediaactivationelement/default.htm">RichMediaActivationElement</a>(annot);
settings.EntryActivation.EntryType = &quot;RichMediaActivation&quot;;
settings.EntryActivation.EntryConfiguration = configuration;
annot.EntryRichMediaSettings = settings;
<a href="../../1391-annotationelement/default.htm">AnnotationElement</a> = annot;
</code></pre></P>
<P><SPAN class=language>[VB]</SPAN><BR><pre><code class="language-vbnet">If mediaType &lt;&gt; &quot;Flash&quot; AndAlso mediaType &lt;&gt; &quot;Video&quot; AndAlso mediaType &lt;&gt; &quot;Sound&quot; AndAlso mediaType &lt;&gt; &quot;3D&quot; Then
&nbsp;&nbsp;Throw New ArgumentException(&quot;Invalid media type.&quot;, &quot;mediaType&quot;)
End If

Dim annot As New <a href="../../2077-richmediaannotationelement/default.htm">RichMediaAnnotationElement</a>(AnnotationElement.Object)
annot.EntrySubtype = &quot;RichMedia&quot;
annot.EntryRect = New <a href="../../../07-syntax/0017-rectangleelement/default.htm">RectangleElement</a>(ArrayAtom.FromXRect(New XRect(rect)), annot.Host)

Dim fileName As String
Dim fileSpec As New <a href="../../../07-syntax/1110-fullfilespecificationelement/default.htm">FullFileSpecificationElement</a>(annot)
fileSpec.EntryType = &quot;Filespec&quot;
If filePathOrUrl.StartsWith(&quot;http://&quot;, StringComparison.OrdinalIgnoreCase) OrElse filePathOrUrl.StartsWith(&quot;https://&quot;, StringComparison.OrdinalIgnoreCase) OrElse filePathOrUrl.StartsWith(&quot;rtmp://&quot;, StringComparison.OrdinalIgnoreCase) Then
&nbsp;&nbsp;fileSpec.EntryFS = &quot;URL&quot;
&nbsp;&nbsp;fileName = FixUrl(filePathOrUrl)
Else
&nbsp;&nbsp;Dim fileInfo As New FileInfo(filePathOrUrl)
&nbsp;&nbsp;fileSpec.EntryEF = New <a href="../../../07-syntax/1111-embeddedfilesetelement/default.htm">EmbeddedFileSetElement</a>(annot)
&nbsp;&nbsp;fileSpec.EntryEF.EntryF = EmbedFileStream(fileInfo)
&nbsp;&nbsp;fileName = EncodeName(fileInfo.Name)
End If
fileSpec.EntryF = fileName
fileSpec.EntryUF = fileName

annot.Object.AdbeExtLevel = New Integer() { 7, 3 }
Dim content As New <a href="../../2086-richmediacontentelement/default.htm">RichMediaContentElement</a>(annot, CreationOptions.Indirect)
content.EntryType = &quot;RichMediaContent&quot;
content.EntryAssets = New <a href="../../../07-syntax/1097-nametreenodeelement_t_/default.htm">NameTreeNodeElement</a>(Of <a href="../../../07-syntax/0011-filespecificationelement/default.htm">FileSpecificationElement</a>)(annot, CreationOptions.Indirect)
content.EntryAssets.EntryNames = New <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>(Of <a href="../../../01-base/1086-element/default.htm">Element</a>)(annot)
content.EntryAssets.EntryNames.Add(New <a href="../../../01-base/1086-element/default.htm">Element</a>(New StringAtom(fileName), annot.Host))
content.EntryAssets.EntryNames.Add(fileSpec)

Dim configuration As New <a href="../../2088-richmediaconfigelement/default.htm">RichMediaConfigElement</a>(annot, CreationOptions.Indirect)
configuration.EntryType = &quot;RichMediaConfiguration&quot;
configuration.EntrySubtype = mediaType
Dim instance As New <a href="../default.htm">RichMediaInstanceElement</a>(annot, CreationOptions.Indirect)
instance.EntryType = &quot;RichMediaInstance&quot;
instance.EntrySubtype = mediaType
instance.EntryParams = New <a href="../../2090-richmediaparamselement/default.htm">RichMediaParamsElement</a>(annot)
instance.EntryParams.EntryType = &quot;RichMediaParams&quot;
instance.EntryParams.EntryBinding = &quot;Foreground&quot;
instance.EntryAsset = fileSpec
configuration.EntryInstances = New <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>(Of <a href="../default.htm">RichMediaInstanceElement</a>)(annot)
configuration.EntryInstances.Add(instance)

content.EntryConfigurations = New <a href="../../../01-base/0001-arrayelement_t_/default.htm">ArrayElement</a>(Of <a href="../../2088-richmediaconfigelement/default.htm">RichMediaConfigElement</a>)(annot)
content.EntryConfigurations.Add(configuration)
annot.EntryRichMediaContent = content

Dim settings As New <a href="../../2078-richmediasettingselement/default.htm">RichMediaSettingsElement</a>(annot, CreationOptions.Indirect)
settings.EntryType = &quot;RichMediaSettings&quot;
settings.EntryActivation = New <a href="../../2079-richmediaactivationelement/default.htm">RichMediaActivationElement</a>(annot)
settings.EntryActivation.EntryType = &quot;RichMediaActivation&quot;
settings.EntryActivation.EntryConfiguration = configuration
annot.EntryRichMediaSettings = settings
<a href="../../1391-annotationelement/default.htm">AnnotationElement</a> = annot
</code></pre></P>

            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<P>&nbsp;</P></BODY></HTML>
