<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML><HEAD><TITLE>XpsImportOperation Import Function. Imports a portion of an XPS document. ABCpdf .NET PDF Library.</TITLE>
<META http-equiv=Content-Type content="text/html; charset=iso-8859-1">
<link rel="stylesheet" href="../../../mystyles.css">
<link rel="stylesheet" href="../../../prism.css">
<script src="../../../prism.js"></script>
<META content="MSHTML 6.00.6000.16640" name=GENERATOR></HEAD>
<BODY bgColor=#ffffff>
<TABLE cellSpacing=4 cellPadding=0 border=0>
  <TBODY>
  <TR>
    <TD vAlign=top><IMG height=60 src="../../../images/goo.gif" width=58></TD>
    <TD width=14>&nbsp;</TD>
    <TD>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD class=pageheader>Import Function</TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR>
        <TR>
          <TD background=../../../images/steel-line-3.gif height=11></TD>
          <TD width=60 background=../../../images/steel-line-3.gif
          height=11></TD>
          <TD height=11><IMG height=11 src="../../../images/steel-blob-11.gif"
            width=11></TD></TR>
        <TR>
          <TD>
            <P>Imports a portion of an XPS document.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10
      src="../../../images/steel-pin.gif" width=64><BR>Syntax</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <P><SPAN class=language>[C#]</SPAN><BR><CODE>void Import(Doc doc,
            string path)<BR></CODE></P>
            <P><CODE><IMG height=10 alt="Throws Exceptions"
            src="../../../images/steel-blob-10.gif" width=10 border=0> may throw
            Exception()</CODE></P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10
      src="../../../images/steel-pin.gif" width=64><BR>Params</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD vAlign=top>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B>Name</B></TD>
                <TD><B>Description</B></TD></TR>
              <TR vAlign=top>
                <TD align=middle>doc</TD>
                <TD>The target PDF document.</TD></TR>
              <TR vAlign=top>
                <TD align=middle>path</TD>
                <TD>The file path to the XPS document.</TD></TR></TBODY></TABLE>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10
      src="../../../images/steel-pin.gif" width=64><BR>Notes</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>Imports an XPS or OXPS Document. By default, the entire XPS document is
            imported.</P>
            <P>An exception will be thrown if the operation is not possible.
            This may happen if the XPS document is corrupt.</P>
            <P>You may notice that colors in the PDF files are slightly different.
            PDF handles alpha blending differently from other file formats. Refer to <A
            href="../../5-swfimportoperation/1-methods/import.htm">SwfImportOperation.Import</A>
            for notes about alpha blending.</P>
            <OL>This method generates events as follows:
              <LI>After the StartPart FixedDocumentSequence is opened, a <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.Document is generated.
              <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
              cellPadding=3 border=5>
                <TBODY>
                <TR>
                  <TD align=middle><B>Name</B></TD>
                  <TD><B>Description</B></TD></TR>
                <TR vAlign=top>
                  <TD>ProcessingObjectEventArgs.Cancel</TD>
                  <TD>See ProcessingObjectEventArgs.Info.DocNumber
below.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/2-handled.htm">ProcessingObjectEventArgs.Info.Handled</A></TD>
                  <TD>Ignored.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/1-sourcetype.htm">ProcessingObjectEventArgs.Info.SourceType</A></TD>
                  <TD>ProcessingSourceType.<B>Document</B></TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/doccount.htm">ProcessingObjectEventArgs.Info.DocCount</A></TD>
                  <TD>The number of FixedDocument's in the 
                    FixedDocumentSequence.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/docnumber.htm">ProcessingObjectEventArgs.Info.DocNumber</A></TD>
                  <TD>The one-based document number of the FixedDocument to be
                    processed. The value of this property for the first of such
                    events for each FixedDocumentSequence is one unless <A
                    href="../../2-processinginfo/2-properties/doccount.htm">DocCount</A>
                    is zero. Subsequent value is the value returned by the event
                    handler for the previous such event plus one if the new
                    value is between 1 and <A
                    href="../../2-processinginfo/2-properties/doccount.htm">DocCount</A>
                    inclusively. Otherwise, it is null. The event handler may
                    change this value between 1 and <A
                    href="../../2-processinginfo/2-properties/doccount.htm">DocCount</A>
                    inclusively. Set it to null to end the processing of all
                    FixedDocument's in the FixedDocumentSequence. If it is null,
                    the corresponding <A
                    href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
                    event is not generated. Otherwise, if ProcessingObjectEventArgs.Cancel
                    is set to true, the corresponding <A
                    href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
                    event is not generated, and the same event is immediately
                    generated again with this value incremented subject to
                    mentioned bounds.</TD></TR></TBODY></TABLE></LI>
              <LI>After a previous <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.Document returns a proper <A
              href="../../2-processinginfo/2-properties/docnumber.htm">DocNumber</A>
              and the FixedDocument is opened, a <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.Page is generated.
              <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
              cellPadding=3 border=5>
                <TBODY>
                <TR>
                  <TD align=middle><B>Name</B></TD>
                  <TD><B>Description</B></TD></TR>
                <TR vAlign=top>
                  <TD>ProcessingObjectEventArgs.Cancel</TD>
                  <TD>See ProcessingObjectEventArgs.Info.PageNumber
                below.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/2-handled.htm">ProcessingObjectEventArgs.Info.Handled</A></TD>
                  <TD>Ignored.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/1-sourcetype.htm">ProcessingObjectEventArgs.Info.SourceType</A></TD>
                  <TD>ProcessingSourceType.<B>Page</B></TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/doccount.htm">ProcessingObjectEventArgs.Info.DocCount</A></TD>
                  <TD>The number of FixedDocument's in the
                    FixedDocumentSequence.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/docnumber.htm">ProcessingObjectEventArgs.Info.DocNumber</A></TD>
                  <TD>The document number of the FixedDocument being
                  processed.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagecount.htm">ProcessingObjectEventArgs.Info.PageCount</A></TD>
                  <TD>The number of FixedPage's in the FixedDocument.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagenumber.htm">ProcessingObjectEventArgs.Info.PageNumber</A></TD>
                  <TD>The one-based page number of the FixedPage to be
                    processed. The value of this property for the first of such
                    events for each FixedDocument is one unless <A
                    href="../../2-processinginfo/2-properties/pagecount.htm">PageCount</A>
                    is zero. Subsequent value is the value returned by the event
                    handler for the previous such event plus one if the new
                    value is between 1 and <A
                    href="../../2-processinginfo/2-properties/pagecount.htm">PageCount</A>
                    inclusively. Otherwise, it is null. The event handler may
                    change this value between 1 and <A
                    href="../../2-processinginfo/2-properties/pagecount.htm">PageCount</A>
                    inclusively. Set it to null to end the processing of all
                    FixedPage's in the FixedDocument. If it is null, the
                    corresponding <A
                    href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
                    event is not generated. Otherwise, if ProcessingObjectEventArgs.Cancel
                    is set to true, the corresponding <A
                    href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
                    event is not generated, and the same event is immediately
                    generated again with this value incremented subject to
                    mentioned bounds.</TD></TR></TBODY></TABLE></LI>
              <LI>After a previous <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.Page returns a proper <A
              href="../../2-processinginfo/2-properties/pagenumber.htm">PageNumber</A>
              and the FixedPage is opened, a <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.PageContent is generated.
              <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
              cellPadding=3 border=5>
                <TBODY>
                <TR>
                  <TD align=middle><B>Name</B></TD>
                  <TD><B>Description</B></TD></TR>
                <TR vAlign=top>
                  <TD>ProcessingObjectEventArgs.Cancel</TD>
                  <TD>If this property is set to true, the page content is not
                    rendered and the corresponding <A
                    href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A> 
                    event is not generated.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/2-handled.htm">ProcessingObjectEventArgs.Info.Handled</A></TD>
                  <TD>The value of this property is false when the event is
                    generated. If it is false when the handler returns, a new
                    page will be created in the target PDF document. The media
                    box, crop box, and art box of the new page are set according
                    to the information in the FixedPage, and the page content is
                    rendered on to the entire page. Set this value to true to
                    render the page content on to <A
                    href="../../../5-abcpdf/doc/2-properties/rect.htm">Doc.Rect</A>
                    of the current page using <A
                    href="../../../5-abcpdf/doc/2-properties/transform.htm">Doc.Transform</A>.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/1-sourcetype.htm">ProcessingObjectEventArgs.Info.SourceType</A></TD>
                  <TD>ProcessingSourceType.<B>PageContent</B></TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/doccount.htm">ProcessingObjectEventArgs.Info.DocCount</A></TD>
                  <TD>The number of FixedDocument's in the
                    FixedDocumentSequence.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/docnumber.htm">ProcessingObjectEventArgs.Info.DocNumber</A></TD>
                  <TD>The document number of the FixedDocument being
                  processed.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagecount.htm">ProcessingObjectEventArgs.Info.PageCount</A></TD>
                  <TD>The number of FixedPage's in the FixedDocument.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagenumber.htm">ProcessingObjectEventArgs.Info.PageNumber</A></TD>
                  <TD>The page number of the FixedPage being processed.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/5-width.htm">ProcessingObjectEventArgs.Info.Width</A></TD>
                  <TD>The width of the FixedPage (as specified on the
                    FixedPage element, not the one on the PageContent element)
                    in 1/96 inches.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/5-width.htm">ProcessingObjectEventArgs.Info.Height</A></TD>
                  <TD>The height of the FixedPage (as specified on the
                    FixedPage element, not the one on the PageContent element)
                    in 1/96 inches.</TD></TR></TBODY></TABLE></LI>
              <LI>While processing page content, a <A
              href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
              event of ProcessingSourceType.Image is generated when an image is
              imported.
              <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
              cellPadding=3 border=5>
                <TBODY>
                <TR>
                  <TD align=middle><B>Name</B></TD>
                  <TD><B>Description</B></TD></TR>
                <TR vAlign=top>
                  <TD>ProcessingObjectEventArgs.Cancel</TD>
                  <TD>Ignored.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/2-handled.htm">ProcessingObjectEventArgs.Info.Handled</A></TD>
                  <TD>Ignored.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/1-sourcetype.htm">ProcessingObjectEventArgs.Info.SourceType</A></TD>
                  <TD>ProcessingSourceType.<B>Image</B></TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/doccount.htm">ProcessingObjectEventArgs.Info.DocCount</A></TD>
                  <TD>The number of FixedDocument's in the
                    FixedDocumentSequence.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/docnumber.htm">ProcessingObjectEventArgs.Info.DocNumber</A></TD>
                  <TD>The document number of the FixedDocument being
                  processed.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagecount.htm">ProcessingObjectEventArgs.Info.PageCount</A></TD>
                  <TD>The number of FixedPage's in the FixedDocument.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/pagenumber.htm">ProcessingObjectEventArgs.Info.PageNumber</A></TD>
                  <TD>The page number of the FixedPage being processed.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/5-width.htm">ProcessingObjectEventArgs.Info.Width</A></TD>
                  <TD>The pixel width of the image.</TD></TR>
                <TR vAlign=top>
                  <TD><A
                    href="../../2-processinginfo/2-properties/5-width.htm">ProcessingObjectEventArgs.Info.Height</A></TD>
                  <TD>The pixel height of the
            image.</TD></TR></TBODY></TABLE></LI></OL>
            <P>Unless stated otherwise, a <A
            href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
            event corresponding to each <A
            href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
            event is generated with an object as follows:</P>
            <TABLE class=wsgtable borderColor=#ffffff cellSpacing=0
            cellPadding=3 border=5>
              <TBODY>
              <TR>
                <TD align=middle><B><A
                  href="../../2-processinginfo/2-properties/1-sourcetype.htm">ProcessingObjectEventArgs.Info.SourceType</A></B></TD>
                <TD><B><A
                  href="../../2-processedobjecteventargs/2-properties/object.htm">ProcessedObjectEventArgs.Object</A> 
                  when <A
                  href="../../2-processedobjecteventargs/2-properties/successful.htm">successful</A></B></TD></TR>
              <TR vAlign=top>
                <TD align=middle>ProcessingSourceType.Document</TD>
                <TD>null</TD></TR>
              <TR vAlign=top>
                <TD align=middle>ProcessingSourceType.Page</TD>
                <TD><A
                  href="../../../6-abcpdf.objects/graphiclayer/default.htm">GraphicLayer</A></TD></TR>
              <TR vAlign=top>
                <TD align=middle>ProcessingSourceType.PageContent</TD>
                <TD>null</TD></TR>
              <TR vAlign=top>
                <TD align=middle>ProcessingSourceType.Image</TD>
                <TD><A
                  href="../../../6-abcpdf.objects/pixmap/default.htm">PixMap</A></TD></TR></TBODY></TABLE>
            <P>Imported images are not compressed. You may wish to analyse and
            compress these <A
            href="../../../6-abcpdf.objects/pixmap/default.htm">PixMap</A>
            objects by pre and post processing them during the <A
            href="../../1-operation/3-events/1-processingobject.htm">ProcessingObject</A>
            and <A
            href="../../1-operation/3-events/2-processedobject.htm">ProcessedObject</A>
            events.</P>
            <P>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR>
  <TR>
    <TD class=sectheader vAlign=top><IMG height=10
      src="../../../images/steel-pin.gif" width=64><BR>Example</TD>
    <TD width=14>&nbsp;</TD>
    <TD vAlign=top>
      <TABLE cellSpacing=0 cellPadding=0 width="100%" border=0>
        <TBODY>
        <TR>
          <TD>
            <P>Here we import the pages with odd page numbers of an XPS document
            up to page 8, 2 pages per sheet in landscape. The aspect ratio is
            preserved and a border is also drawn.</P>
            <P><SPAN class=language>[C#]</SPAN><BR>
            <pre><code class="language-csharp">using var doc = new Doc();
var importOp = new MyImportOperation(doc);
importOp.Import("../mypics/AdvancedGraphicsExamples.xps");
doc.Save("xps.pdf");
</code></pre>
            </P>
            <P>
            <P></P>
            <P><SPAN class=language>[C#]</SPAN><BR>
            </P>
            <pre><code class="language-csharp">class MyImportOperation {
&nbsp;&nbsp;private Doc _doc = null;
&nbsp;&nbsp;private double _margin = 10;
&nbsp;&nbsp;private int _pagesAdded = 0;

&nbsp;&nbsp;public MyImportOperation(Doc doc) {
&nbsp;&nbsp;&nbsp;&nbsp;_doc = doc;

&nbsp;&nbsp;&nbsp;&nbsp;_doc.Transform.Rotate(90, _doc.MediaBox.Left, _doc.MediaBox.Bottom);
&nbsp;&nbsp;&nbsp;&nbsp;_doc.Transform.Translate(_doc.MediaBox.Width, 0);

&nbsp;&nbsp;&nbsp;&nbsp;int id = _doc.GetInfoInt(_doc.Root, "Pages");
&nbsp;&nbsp;&nbsp;&nbsp;_doc.SetInfo(id, "/Rotate", "90");
&nbsp;&nbsp;}

&nbsp;&nbsp;public void Import(string inPath) {
&nbsp;&nbsp;&nbsp;&nbsp;using (XpsImportOperation op = new XpsImportOperation()) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op.ProcessingObject += Processing;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op.ProcessedObject += Processed;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;op.Import(_doc, inPath);
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}

&nbsp;&nbsp;public void Processing(object sender, ProcessingObjectEventArgs e) {
&nbsp;&nbsp;&nbsp;&nbsp;if (e.Info.SourceType == ProcessingSourceType.Page &amp;&amp; e.Info.PageNumber != null) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((e.Info.PageNumber % 2) == 0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Info.PageNumber++;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (e.Info.PageNumber &gt;= 8)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Info.PageNumber = null;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Tag = e.Info.PageNumber;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;else if (e.Info.SourceType == ProcessingSourceType.PageContent) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ((_pagesAdded % 2) == 0)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.Page = _doc.AddPage();

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double width = _doc.MediaBox.Height;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double height = _doc.MediaBox.Width;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double scale = Math.Min((width - 4 * _margin) / (2 * e.Info.Width.Value),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(height - 2 * _margin) / e.Info.Height.Value);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double rectWidth = scale * e.Info.Width.Value;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double rectHeight = scale * e.Info.Height.Value;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double distanceX = (width - 2 * rectWidth) / 3;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;double distanceY = (height - rectHeight) / 2;

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.Rect.SetRect(distanceX + (_pagesAdded % 2) * (distanceX + rectWidth),
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;distanceY, rectWidth, rectHeight);

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;e.Info.Handled = true;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_pagesAdded++;
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}

&nbsp;&nbsp;public void Processed(object sender, ProcessedObjectEventArgs e) {
&nbsp;&nbsp;&nbsp;&nbsp;if (e.Successful) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var pixmap = e.Object as PixMap;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (pixmap != null)
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pixmap.Compress();

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;var graphic = e.Object as GraphicLayer;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (graphic != null) {
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.FrameRect();

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int pageNumber = (int)e.Tag;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.FontSize = 16;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.TextStyle.HPos = 0.5;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.Rect.Top = _doc.Rect.Bottom - _margin;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.Rect.Bottom = _doc.MediaBox.Bottom;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_doc.AddText(string.Format("Page {0}", pageNumber));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;&nbsp;&nbsp;}
&nbsp;&nbsp;}
}
</code></pre>
            </P>
            <P>
            </P>
            <P></P>
            <P><BR><IMG src="../../../images/pdf/xps.pdf.png" class="example-landscape"> <IMG
            src="../../../images/pdf/xps.pdf2.png" class="example-landscape"></P>
            <P><BR>&nbsp;</P></TD>
          <TD width=60>&nbsp;</TD>
          <TD width=11>&nbsp;</TD></TR></TBODY></TABLE></TD></TR></TBODY></TABLE>
<P>&nbsp;</P></BODY></HTML>
